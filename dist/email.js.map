{"version":3,"sources":["../src/email.js"],"names":["Email","app","post","callback","email","from","_","get","to","message","postId","downloadLink","url","messageOptions","subject","text","html","sendMail","err","info","console","log"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;IAEqBA,K;AAGjB,mBAAYC,GAAZ,EAAgB;AAAA;;AAEZ,aAAKA,GAAL,GAAWA,GAAX;AACH;;;;yCAGgBC,I,EAA0B;AAAA,gBAApBC,QAAoB,uEAAT,YAAM,CAAE,CAAC;;;AAGvC,gBAAMF,MAAM,KAAKA,GAAjB;AACA,gBAAMG,QAAQH,IAAIG,KAAlB;;AAEA,gBAAMC,OAAOC,iBAAEC,GAAF,CAAML,IAAN,EAAW,MAAX,CAAb,CANuC,CAML;AAClC,gBAAMM,KAAKF,iBAAEC,GAAF,CAAML,IAAN,EAAY,IAAZ,CAAX;AACA,gBAAMO,UAAUH,iBAAEC,GAAF,CAAML,IAAN,EAAY,SAAZ,EAAuB,EAAvB,CAAhB;AACA,gBAAMQ,SAASJ,iBAAEC,GAAF,CAAML,IAAN,EAAY,KAAZ,CAAf;AACA,gBAAMS,eAAkBC,WAAlB,eAA+BF,MAArC;;AAEA,gBAAIG,iBAAiB;AACjBR,sBAAMA,IADW,EACL;AACZG,oBAAIA,EAFa,EAET;AACRM,yBAAS,6BAHQ;AAIjBC,sBAAMN,OAJW;AAKjBO,8BAAYX,IAAZ,8CAAyDM,YAAzD,+CAA+GF,OAA/G;AALiB,aAArB;;AAQA;AACAL,kBAAMa,QAAN,CAAeJ,cAAf,EAA+B,UAACK,GAAD,EAAMC,IAAN,EAAe;;AAE1CC,wBAAQC,GAAR,CAAY,gCAAZ,EAA8CH,GAA9C,EAAmDC,IAAnD;;AAEA,uBAAOhB,SAASe,GAAT,EAAcC,IAAd,CAAP;AACH,aALD;AAMH;;;;;;kBApCgBnB,K","file":"email.js","sourcesContent":["import _ from 'lodash'\r\nimport {url} from \"./config\";\r\n\r\nexport default class Email {\r\n\r\n\r\n    constructor(app){\r\n\r\n        this.app = app;\r\n    }\r\n\r\n\r\n    sendDownloadLink(post, callback = () => {}){\r\n\r\n\r\n        const app = this.app;\r\n        const email = app.email;\r\n\r\n        const from = _.get(post,'from');  // post.from;\r\n        const to = _.get(post, 'to');\r\n        const message = _.get(post, 'message', '');\r\n        const postId = _.get(post, '_id');\r\n        const downloadLink = `${url}/share/${postId}`;\r\n\r\n        let messageOptions = {\r\n            from: from, // sender address\r\n            to: to, // list of receivers\r\n            subject: '[Share] Download Invitation',\r\n            text: message,\r\n            html: `<p>${from} has sent to you file. Click <a href=\"${downloadLink}\">here</a> to download.</p><p>Message: ${message}</p>`\r\n        };\r\n\r\n        // send mail with defined transport object\r\n        email.sendMail(messageOptions, (err, info) => {\r\n\r\n            console.log(\"Sending an email with callback\", err, info);\r\n\r\n            return callback(err, info);\r\n        });\r\n    }\r\n}"]}